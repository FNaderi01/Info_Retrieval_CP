      Skip to content
                Sign up
                    Why GitHub?
                    Features →
                      Code review
                      Project management
                      Integrations
                      Actions
                      Packages
                      Security
                      Team management
                      Hosting
                      Mobile
                      Customer stories →
                      Security →
                Team
                Enterprise
                    Explore
                      Explore GitHub →
                    Learn &amp; contribute
                      Topics
                        Collections
                      Trending
                      Learning Lab
                      Open source guides
                    Connect with others
                      Events
                      Community forum
                      GitHub Education
                      GitHub Stars program
                Marketplace
                    Pricing
                    Plans →
                      Compare plans
                      Contact Sales
                      Nonprofit →
                      Education →
     -->
        In this repository
        All GitHub
      ↵
      Jump to
      ↵
    No suggested jump to results
        In this repository
        All GitHub
      ↵
      Jump to
      ↵
        In this repository
        All GitHub
      ↵
      Jump to
      ↵
          Sign in
              Sign up
      {{ message }}
      palantir
    /
    spark-tpcds-benchmark
    Watch
      7
      Star
      5
          Fork
        6
        Utility for benchmarking changes in Spark using TPC-DS workloads
            Apache-2.0 License
        5
        stars
        6
        forks
      Star
    Watch
            Code
            Issues
              2
            Pull requests
              6
            Actions
            Projects
              0
            Security
            Insights
            More
                    Code
                    Issues
                    Pull requests
                    Actions
                    Projects
                    Security
                    Insights
          Dismiss
        Join GitHub today
        GitHub is home to over 50 million developers working together to host and review code, manage projects, and build software together.
        Sign up
      develop
      15
      branches
      19
      tags
    Go to file
      Code
  Clone
       -->
            HTTPS
            GitHub CLI
        Use Git or checkout with SVN using the web URL.
      Work fast with our official CLI.
      Learn more.
                Open with GitHub Desktop
                Download ZIP
          Launching GitHub Desktop
          If nothing happens, download GitHub Desktop and try again.
          Go back
          Launching GitHub Desktop
          If nothing happens, download GitHub Desktop and try again.
          Go back
          Launching Xcode
          If nothing happens, download Xcode and try again.
          Go back
          Launching Visual Studio
          If nothing happens, download the GitHub extension for Visual Studio and try again.
          Go back
    Latest commit
        Git stats
                    257
                  commits
  Files
      Permalink
    Failed to load latest commit information.
        Type
        Name
        Latest commit message
        Commit time
            .baseline
            .circleci
            .github
            .palantir
            changelog
            gradle
            jars/org/apache/spark/spark-hadoop-cloud_2.12/3.0.0
            scripts
            spark-tpcds-benchmark-runner
            .bulldozer.yml
            .changelog.yml
            .excavator.yml
            .gitignore
            .policy.yml
            LICENSE
            build.gradle
            gradle.properties
            gradlew
            gradlew.bat
            readme.md
            settings.gradle
            versions.lock
            versions.props
        View code
        readme.md
Spark Benchmark Runner
This repo contains tools to run 2 industry standard benchmark suites:
TPC-DS is an open benchmark suite for structured data systems. This utility aims to make it easy to generate TPC-DS data, and to run TPC-DS benchmarks against different versions of Spark. The main use case for this utility is to test performance at scale when evaluating changes to Spark or to its underlying infrastructure. The benchmarks run SQL queries against structured datasets. This utility is thus not useful for running tests in streaming workflows.
Sort Benchmark: This is a single benchmark that sorts a large amount of data generated by the gensort program.
The benchmark suite can be run on MacOS or CentOS 6+. It does not currently support running on Windows.
Usage
The benchmark suite requires a storage layer, distributed (such as HDFS/S3/Azure Blob Storage) or local to store the generated test data, as well as the computation results. This tool supports running the benchmarks either in local spark mode on a single JVM, or with a cluster manager, such as YARN when running distributed benchmarks on several machines.
Download the latest version of the distribution from https://bintray.com/palantir/releases/spark-tpcds-benchmark.
Upload and unpack the distribution to a node in the cluster.
In the distribution, edit var/conf/config.yml to match the benchmarking environment you will run with. Documentation for the various configurable options are described in the config.yml file.
Storage Layer:
This tool supports any Hadoop compatible storage layer (eg S3/ABS/HDFS). Once that is setup, the credentials and account details can be updated in the hadoop configuration section. Placeholder configuration blocks are provided for S3, ABS and HDFS.
Compute Layer:
When running with local spark, the spark configuration section in config.yml should work out of the box.
When running on a cluster manager, the cluster first needs to be installed and configured. If you use YARN, this and this are good places to start. Once that is done, the spark and hadoop configuration sections need to be changed to point to the cluster manager.
Ephemeral Disks
We recommend setting hadoop.tmp.dir to a fast SSD drive for each machine. It is set to a subfolder in /scratch by default.
On AWS, we typically use m5d/r5d instance types, which already come with  NVMe SSD ephemeral disks, but are not mounted anywhere. We use this script to mount it to scratch. These already come with hardware level encryption, so no LUKS encryption is necessary.
On Azure, we typically use hc44rs or d48ds_v4 instance types. These come with SSD ephemeral disks and aren't mounted either. They also do not have hardware level encryption as of the time of writing (July 2020). We use this script to mount and LUKS encrypt them.
Set the JAVA_HOME environment variable to point to Java 11.
Run service/bin/init.sh start. The benchmarks will begin running in the background. The driver exits upon
completing the benchmark suite.
The performance results of running the benchmarks can be found in JSON files located under benchmark_results/ in the specified metrics filesystem.
You may use a Spark shell to load these JSON files into DataFrames for additional analysis, or download these JSON files
for processing by other tools. Results are grouped by data scale defined by the configuration's dataScalesGb, described below.
For TPC-DS, the correctness of the computation is checked against the results of previous executions of the benchmark against the
same set of data. If the source data is regenerated and the previous source data is overwritten, the computation results
from previous runs are also invalidated.
            About
      Utility for benchmarking changes in Spark using TPC-DS workloads
  Resources
      Readme
  License
        Apache-2.0 License
    Releases
      19
        0.3.0
          Latest
      Jul 24, 2020
        + 18 releases
    Packages 0
        No packages published 
    Contributors 5
              Languages
        Java
        97.2%
        Shell
        2.8%
        © 2020 GitHub, Inc.
          Terms
          Privacy
  Cookie Preferences
          Security
          Status
          Help
          Contact GitHub
          Pricing
        API
        Training
          Blog
          About
    You can’t perform that action at this time.
    You signed in with another tab or window. Reload to refresh your session.
    You signed out in another tab or window. Reload to refresh your session.
  We use optional third-party analytics cookies to understand how you use GitHub.com so we can build better products.
              Learn more.
              Accept
              Reject
  We use optional third-party analytics cookies to understand how you use GitHub.com so we can build better products.
              You can always update your selection by clicking Cookie Preferences at the bottom of the page.
              For more information, see our Privacy Statement.
              Essential cookies
              We use essential cookies to perform essential website functions, e.g. they're used to log you in. 
                Learn more
              Always active
              Analytics cookies
              We use analytics cookies to understand how you use our websites so we can make them better, e.g. they're used to gather information about the pages you visit and how many clicks you need to accomplish a task. 
                Learn more
                Accept
                Reject
            Save preferences
